---
title: Isolated patches for stored and reflected XSS vulnerabilities in Adobe Commerce
description: Apply the isolated patches to address two critical XSS vulnerabilities in Adobe Commerce. The first is a Stored XSS that allows a low-privileged user to inject JavaScript into admin pages via server-side template injection. The second is a Reflected XSS in marketplace.magento.com that can be chained to Adobe IMS endpoints (services.adobe.com) to execute a one-click account takeover (ATO). 
feature: Compliance, Security
role: Developer
---

# Isolated patches for stored and reflected XSS vulnerabilities in Adobe Commerce

This article provides isolated patches to address two critical XSS vulnerabilities in Adobe Commerce. The first is a Stored XSS that allows a low-privileged user to inject arbitrary JavaScript code into admin pages via server-side template injection. The second is a Reflected XSS in [marketplace.magento.com](/https://marketplace.magento.com) that can be chained to Adobe IMS endpoints (services.adobe.com) to execute a one-click account takeover (ATO). 

## Issues

### I. CVE-2025-47110: Stored XSS via Server-Side Template Injection in Adobe Commerce 2.4.7-p4

A Stored XSS vulnerability allows attackers with limited privileges (e.g., marketing users) to inject malicious JavaScript into every admin page. This is achieved by exploiting server-side template injection in the email template preview feature, bypassing the fix for CVE-2023-29297.

<u>Affected products and versions:</u>

Adobe Commerce (all deployment menthods)

* 2.4.9-alpha1 
* 2.4.8-p1 and earlier
* 2.4.7-p6 and earlier
* 2.4.6-p11 and earlier
* 2.4.5-p13 and earlier
* 2.4.4-p14 and earlier

<u>Steps to reproduce:</u>

1. Navigate to **[!UICONTROL Marketing]** > **[!UICONTROL Communications]** > **[!UICONTROL Email Templates]**.
1. Create a new email template with the following payload in the content field:

    `block id=zz class=Magento\UrlRewrite\Block\Link nameInLayout="admin_top_nav|Magento_Backend::dashboard|1|en_US" cache_lifetime=10000 label="<script>alert(0)</script>" itemUrl=z itemName=zz` 
    
    Don't save or preview at this stage.
1. Run `bin/magento cache:clean` in the console (optional for easier reproduction).
1. Click **[!UICONTROL Preview template]**.
1. The admin should have its administrative panel poisoned with an alert(0) on every page.

<u>Solution:</u>

For Adobe Commerce versions:

* 2.4.4, 2.4.4-p1, 2.4.4-p2, 2.4.4-p3, 2.4.4-p4, 2.4.4-p5, 2.4.4-p6, 2.4.4-p7, 2.4.4-p8, 2.4.4-p9, 2.4.4-p10, 2.4.4-p11, 2.4.4-p12, 2.4.4-p13

* 2.4.5, 2.4.5-p1, 2.4.5-p2, 2.4.5-p3, 2.4.5-p4, 2.4.5-p5, 2.4.5-p6, 2.4.5-p7, 2.4.5-p8, 2.4.5-p9, 2.4.5-p10, 2.4.5-p11, 2.4.5-p12

* 2.4.6, 2.4.6-p1, 2.4.6-p2, 2.4.6-p3, 2.4.6-p4, 2.4.6-p5, 2.4.6-p6, 2.4.6-p7, 2.4.6-p8, 2.4.6-p10

* 2.4.7, 2.4.7-p1, 2.4.7-p2, 2.4.7-p3, 2.4.7-p4, 2.4.7-p5

* 2.4.8

Apply the following isolated patch or upgrade to the latest secure patch.

[VULN-31609_2.4.X.patch](assets/VULN-31609_2.4.X_patch.zip)

### II. CVE-2025-47109: Reflected XSS in marketplace.magento.com + one-click ATO issue impacting IMS instances

A reflected XSS vulnerability exists in [marketplace.magento.com](/https://marketplace.magento.com) which when chained to Adobe IMS endpoints (services.adobe.com) enables a one-click account takeover (ATO).
