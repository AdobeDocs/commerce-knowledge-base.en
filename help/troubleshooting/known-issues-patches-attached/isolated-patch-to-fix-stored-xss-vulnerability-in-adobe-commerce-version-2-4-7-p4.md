---
title: Isolated patches for stored and reflected XSS vulnerabilities in Adobe Commerce
description: Apply the isolated patches to address two critical XSS vulnerabilities in Adobe Commerce. The first is a Stored XSS that allows a low-privileged user to inject JavaScript into admin pages via server-side template injection. The second is a Reflected XSS in marketplace.magento.com that can be chained to Adobe IMS endpoints (services.adobe.com) to execute a one-click account takeover (ATO). 
feature: Compliance, Security
role: Developer
---

# Isolated patches for stored and reflected XSS vulnerabilities in Adobe Commerce

This article provides isolated patches to address two critical XSS vulnerabilities in Adobe Commerce. The first is a Stored XSS that allows a low-privileged user to inject arbitrary JavaScript code into admin pages via server-side template injection. The second is a Reflected XSS in [marketplace.magento.com](/https://marketplace.magento.com) that can be chained to Adobe IMS endpoints (services.adobe.com) to execute a one-click account takeover (ATO). 

## Issues

### I. CVE-2025-47110: Stored XSS via Server-Side Template Injection in Adobe Commerce 2.4.7-p4

A Stored XSS vulnerability allows attackers with limited privileges (e.g., marketing users) to inject malicious JavaScript into every admin page. This is achieved by exploiting server-side template injection in the email template preview feature, bypassing the fix for CVE-2023-29297.

<u>Affected products and versions:</u>

Adobe Commerce (all deployment menthods)

* 2.4.9-alpha1 
* 2.4.8-p1 and earlier
* 2.4.7-p6 and earlier
* 2.4.6-p11 and earlier
* 2.4.5-p13 and earlier
* 2.4.4-p14 and earlier

<u>Steps to reproduce:</u>

1. Navigate to **[!UICONTROL Marketing]** > **[!UICONTROL Communications]** > **[!UICONTROL Email Templates]**.
1. Create a new email template with the following payload in the content field:

    `block id=zz class=Magento\UrlRewrite\Block\Link nameInLayout="admin_top_nav|Magento_Backend::dashboard|1|en_US" cache_lifetime=10000 label="<script>alert(0)</script>" itemUrl=z itemName=zz` 
    
    Don't save or preview at this stage.
1. Run `bin/magento cache:clean` in the console (optional for easier reproduction).
1. Click **[!UICONTROL Preview template]**.
1. The admin should have its administrative panel poisoned with an alert(0) on every page.

<u>Solution:</u>

For Adobe Commerce versions:

* 2.4.4, 2.4.4-p1, 2.4.4-p2, 2.4.4-p3, 2.4.4-p4, 2.4.4-p5, 2.4.4-p6, 2.4.4-p7, 2.4.4-p8, 2.4.4-p9, 2.4.4-p10, 2.4.4-p11, 2.4.4-p12, 2.4.4-p13

* 2.4.5, 2.4.5-p1, 2.4.5-p2, 2.4.5-p3, 2.4.5-p4, 2.4.5-p5, 2.4.5-p6, 2.4.5-p7, 2.4.5-p8, 2.4.5-p9, 2.4.5-p10, 2.4.5-p11, 2.4.5-p12

* 2.4.6, 2.4.6-p1, 2.4.6-p2, 2.4.6-p3, 2.4.6-p4, 2.4.6-p5, 2.4.6-p6, 2.4.6-p7, 2.4.6-p8, 2.4.6-p10

* 2.4.7, 2.4.7-p1, 2.4.7-p2, 2.4.7-p3, 2.4.7-p4, 2.4.7-p5

* 2.4.8

Apply the following isolated patch or upgrade to the latest secure patch.

[VULN-31609_2.4.X.patch](assets/VULN-31609_2.4.X_patch.zip)

### II. CVE-2025-47109: Reflected XSS in marketplace.magento.com + one-click ATO issue impacting IMS instances

A reflected XSS vulnerability exists in [marketplace.magento.com](/https://marketplace.magento.com) which when chained to Adobe IMS endpoints (services.adobe.com) enables a one-click account takeover (ATO).

<u>Affected products and versions:</u>

Adobe Commerce (all deployment menthods) 

* 2.4.9-alpha1 
* 2.4.8-p1 and earlier

<u>Steps to reproduce:</u>

1. In the backend, go to **[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL Catalog]** > 
**[!UICONTROL Catalog]** > **[!UICONTROL Search Engine Optimization]** and enable *[!UICONTROL Use Canonical Link Meta Tag For Categories]*.
1. Populate a category to ensure multiple pages of results.
1. Create two products and assign them to the category.
1. Go to **[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL Catalog]** > **[!UICONTROL Storefront]** and set:
    * [!UICONTROL Products per Page on Grid Allowed Values]: 1, 12, 24, 36
    * [!UICONTROL Products per Page on Grid Default Value]: 1
        
1. Visit the category page on the frontend. 

    ```
    https://\ {magento_url}
    /women/tops-women.html?p=2%22%3E%3Csvg/onload=alert(document.domain)%3E
    ```

1. Observe a popup displaying the domain name.

<u>Solution:</u>

For Adobe Commerce version 2.4.8, apply the following isolated patch or upgrade to the latest secure patch.

[VULN-31547_2.4.8.patch](assets/VULN-31547_2.4.8_patch.zip)

## How to apply the Isolated patch

Unzip the file and see [How to apply a composer patch provided by Adobe](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/how-to/how-to-apply-a-composer-patch-provided-by-magento.html) in our support knowledge base for instructions.

## For Adobe Commerce on Cloud merchants only - How to tell whether the Isolated patches have been applied

Considering that it isn't possible to easily check if the issue was patched, you might want to check whether the [!DNL CVE-2024-39397] Isolated patch has been successfully applied. 

<u>You can do this by taking the following steps, using the file `VULN-27015-2.4.7_COMPOSER.patch` as an example</u>:

1. [Install the Quality Patches Tool](https://experienceleague.adobe.com/docs/commerce-operations/tools/quality-patches-tool/usage.html).
1. Run the command:<br>
 ![cve-2024-34102-tell-if-patch-applied-code](assets/cve-2024-34102-tell-if-patch-applied-code.png)
1. You should see output similar to this, where VULN-27015 returns the *Applied* status:

    ```bash
    ║ Id            │ Title                                                        │ Category        │ Origin                 │ Status      │ Details                                          ║ ║ N/A           │ ../m2-hotfixes/VULN-27015-2.4.7_COMPOSER_patch.patch      │ Other           │ Local                  │ Applied     │ Patch type: Custom                                
    ```
    